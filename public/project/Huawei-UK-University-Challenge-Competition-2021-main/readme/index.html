<!DOCTYPE html><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.5.0 for Hugo" />
  

  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Rabia YAŞA KOŞTAŞ" />

  
  
  
    
  
  <meta name="description" content="Our solution is the winner of the Huawei UK University Challenge Competition 2021" />

  
  <link rel="alternate" hreflang="en-us" href="https://example.com/project/huawei-uk-university-challenge-competition-2021-main/readme/" />

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.c7b8d9abd591ba2253ea42747e3ac3f5.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.1052fab8b7700a3dc49ee23683097d66.css" />

  



  


  


  




  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hu8d234a82ff4dd5c4a89888184de83dc4_18106_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu8d234a82ff4dd5c4a89888184de83dc4_18106_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://example.com/project/huawei-uk-university-challenge-competition-2021-main/readme/" />

  
  
  
  
  
  
  
  
    
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary" />
  
    <meta property="twitter:site" content="@wowchemy" />
    <meta property="twitter:creator" content="@wowchemy" />
  
  <meta property="og:site_name" content="Academic" />
  <meta property="og:url" content="https://example.com/project/huawei-uk-university-challenge-competition-2021-main/readme/" />
  <meta property="og:title" content="Data Science for Indoor positioning | Academic" />
  <meta property="og:description" content="Our solution is the winner of the Huawei UK University Challenge Competition 2021" /><meta property="og:image" content="https://example.com/media/icon_hu8d234a82ff4dd5c4a89888184de83dc4_18106_512x512_fill_lanczos_center_3.png" />
    <meta property="twitter:image" content="https://example.com/media/icon_hu8d234a82ff4dd5c4a89888184de83dc4_18106_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2022-04-27T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2022-04-27T00:00:00&#43;00:00">
  

  


    









<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://example.com/project/huawei-uk-university-challenge-competition-2021-main/readme/"
  },
  "headline": "Data Science for Indoor positioning",
  
  "datePublished": "2022-04-27T00:00:00Z",
  "dateModified": "2022-04-27T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Rabia YAŞA KOŞTAŞ"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Academic",
    "logo": {
      "@type": "ImageObject",
      "url": "https://example.com/media/icon_hu8d234a82ff4dd5c4a89888184de83dc4_18106_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "Our solution is the winner of the Huawei UK University Challenge Competition 2021"
}
</script>

  

  

  

  





  <title>Data Science for Indoor positioning | Academic</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="42e440a0e3976a1f7ea38de24133ac38" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.2ed908358299dd7ab553faae685c746c.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Academic</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Academic</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#posts"><span>Posts</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#projects"><span>Projects</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#news"><span>News</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article article-project">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Data Science for Indoor positioning</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Apr 27, 2022
  </span>
  

  

  

  
  
  
  

  
  

</div>

    




<div class="btn-links mb-3">
  
  








  


















  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary btn-page-header" href="https://twitter.com/kkostas" target="_blank" rel="noopener">
    <i class="fab fa-twitter mr-1"></i>Follow</a>

  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary btn-page-header" href="https://github.com/kahramankostas/Huawei-UK-University-Challenge-Competition-2021" target="_blank" rel="noopener">
    <i class="fab fa-github mr-1"></i>Github</a>


</div>


  
</div>



  <div class="article-container">

    <div class="article-style">
      <img src="images/turkuaz.png" alt="drawing" width="1200"/>
<h2 id="our-solution-is-the-winner-of-the-huawei-uk-university-challenge-competition-2021">Our solution is the winner of the Huawei UK University Challenge Competition 2021.</h2>
<ul>
<li>Members:
<ul>
<li><strong>Rabia Yasa Kostas</strong></li>
<li><strong>Kahraman Kostas</strong></li>
</ul>
</li>
</ul>
<p>The team presenter: <strong>Kahraman Kostas</strong></p>
<h3 id="you-can-download-the-original-versions-of-the-questions-given-in-the-competition-here--task-1-httpsdrivegooglecomfiled1ub8lisg13y6mdyemqwr3ij1kmbnrqlepviewuspsharing---task-2-httpsdrivegooglecomfiled194osp15bkebktx9kemlp-qxg6yd0zkloviewuspsharing">You can download the original versions of the questions given in the competition here: <a href="https://drive.google.com/file/d/1UB8lISg13y6MdyEmQWR3iJ1kMbNrQLEP/view?usp=sharing" target="_blank" rel="noopener"> Task 1 </a> &amp; <a href="https://drive.google.com/file/d/194oSp15BkEBktx9kEmLP-qXg6YD0ZklO/view?usp=sharing" target="_blank" rel="noopener"> Task 2 </a></h3>
<center> <h1>TASK 1 QUESTION</h1> </center> 
<h2 id="11-wifi-similarity-introduction">1.1 WiFi Similarity Introduction</h2>
<p>To get you started we&rsquo;ve put together a simple problem to introduce some key indoor positioning concepts. Consider the following environment: a user is travelling in open space in the presence of 3 WiFi emitters (we call the data created by this user a trajectory). Each emitter has a unique mac address. The user is equipped with a smartphone that will periodically scan the WiFi environment and record the RSSI of each detected mac (in dB).</p>
<p>For this model we have used a standard log-loss free-space propagation model for each of the emitters. This is a simplistic model that works well in free space, but breaks down in real indoor environments with walls and other obstacles which can bounce the signals around in a more complex manner. In general we do expect to see a steep drop in RSSI over distance as the fixed energy from the emitting antenna is spread over an increasing area as the wave propagates. In the diagram below each circle denotes a drop of 10dB.</p>
<p>The user walks North-East from point (0,0) and there phone makes three scans of the environment. The data recorded at each scan is shown below.</p>
<pre tabindex="0"><code>scan 0 -&gt; {&#39;green&#39;: -60, &#39;blue&#39;: -66, &#39;red&#39;: -67}
scan 1 -&gt; {&#39;green&#39;: -58, &#39;blue&#39;: -61, &#39;red&#39;: -60} 
scan 2 -&gt; {&#39;green&#39;: -66, &#39;blue&#39;: -62, &#39;red&#39;: -59}
</code></pre><p>The complex and locally unique properties of the WiFi environment make it very useful for indoor positioning systems. For example in the below image <code>scan 1</code> measures data at roughly the centroid of the three emitters and there is no other place in this environment where one could take a reading that would register similar RSSI values. Given a set of scans or &ldquo;fingerprints&rdquo; from independent trajectories, we are interested in calculating how similar they are in WiFi space as this is an indication of how close they are in real space.</p>
<p>Your first challenge is to write a function to calculate the <em>Euclidean Distance</em> and <em>Manhattan Distance</em> metrics between each of the scans in the sample trajectory that we introduced above. Using the data from a single trajectory is a good way to test the quality of a similarity metric as we can get fairly accurate estimates of the true distance using the data from the phone&rsquo;s intertial measurement unit (IMU) which is used by a pedestrian dead reckoning (PDR) module.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="images/intro_1.png" alt="intro_1.png" loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">euclidean</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span> <span class="n">fp2</span><span class="p">):</span>   
</span></span><span class="line"><span class="cl">    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">manhattan</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span> <span class="n">fp2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># solution of the above functions</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">distance</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">euclidean</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span> <span class="n">fp2</span><span class="p">):</span>   
</span></span><span class="line"><span class="cl">    <span class="n">fp1</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">fp1</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">fp2</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">fp2</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span>  <span class="n">distance</span><span class="o">.</span><span class="n">euclidean</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span> <span class="n">fp2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">manhattan</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span> <span class="n">fp2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">fp1</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">fp1</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">fp2</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">fp2</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span>  <span class="n">distance</span><span class="o">.</span><span class="n">cityblock</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span> <span class="n">fp2</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">metrics</span> <span class="kn">import</span> <span class="n">eval_dist_metric</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;intro_trajectory_1.json&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">traj</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Pre-calculate the pair indexes we are interested in</span>
</span></span><span class="line"><span class="cl"><span class="n">keys</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">fp1</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;fps&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">fp2</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;fps&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">         <span class="c1"># only calculate the upper triangle</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">fp1</span><span class="p">[</span><span class="s1">&#39;step_index&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">fp2</span><span class="p">[</span><span class="s1">&#39;step_index&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">            <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">fp1</span><span class="p">[</span><span class="s1">&#39;step_index&#39;</span><span class="p">],</span> <span class="n">fp2</span><span class="p">[</span><span class="s1">&#39;step_index&#39;</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1">## Get the distances from PDR</span>
</span></span><span class="line"><span class="cl"><span class="n">true_d</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">step1</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;steps&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">step2</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;steps&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">step1</span><span class="p">[</span><span class="s1">&#39;step_index&#39;</span><span class="p">],</span><span class="n">step2</span><span class="p">[</span><span class="s1">&#39;step_index&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">true_d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">step1</span><span class="p">[</span><span class="s1">&#39;di&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">step2</span><span class="p">[</span><span class="s1">&#39;di&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="n">euc_d</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="n">man_d</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">fp1</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;fps&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">fp2</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[</span><span class="s1">&#39;fps&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">        <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">fp1</span><span class="p">[</span><span class="s1">&#39;step_index&#39;</span><span class="p">],</span><span class="n">fp2</span><span class="p">[</span><span class="s1">&#39;step_index&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">euc_d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">euclidean</span><span class="p">(</span><span class="n">fp1</span><span class="p">[</span><span class="s1">&#39;profile&#39;</span><span class="p">],</span><span class="n">fp2</span><span class="p">[</span><span class="s1">&#39;profile&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">man_d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">manhattan</span><span class="p">(</span><span class="n">fp1</span><span class="p">[</span><span class="s1">&#39;profile&#39;</span><span class="p">],</span><span class="n">fp2</span><span class="p">[</span><span class="s1">&#39;profile&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Euclidean Average Error&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">eval_dist_metric</span><span class="p">(</span><span class="n">euc_d</span><span class="p">,</span> <span class="n">true_d</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Manhattan Average Error&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">eval_dist_metric</span><span class="p">(</span><span class="n">man_d</span><span class="p">,</span> <span class="n">true_d</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>Euclidean Average Error
9.29
Manhattan Average Error
4.90
</code></pre><p>If you correctly implemented the functions you should have seen that the average error for the euclidean metric was <code>9.29</code> whilst the Manhattan was only <code>4.90</code>. So for this data, the Manhattan distance is a better estimate of the true distance.</p>
<p>This is of course a very simplistic model. Indeed, there is no direct relationship between the RSSI values and the free space distance in this way. Typically, when we create our own estimates for distance we would use the known pdr distances from within a trajectory to fit the numeric score to a physical distance estimate.</p>
<h2 id="12-wifi-similarity-metric">1.2 WiFi Similarity Metric</h2>
<p>For your main challenge, we would like you to develop your own metric to estimate the real-world distance between two scans, based solely on their WiFi fingerprints. We will provide you with real crowdsourced data collected early in 2021 from a single mall. The data will contain 114661 fingerprints scans and 879824 distances between the scans. The distances will be our best estimate of the true distance given additional information that we will take into account.</p>
<p>We will provide a test set of fingerprint pairs and you will need to write a function that tells us how far apart they are.</p>
<p>This function could be as simple as a variation on one of the metrics that we introduced above or as complex as a full machine learning solution that learns to weight different mac addresses (or mac address combinations) differently in different situations.</p>
<p>Some final points to consider:</p>
<ul>
<li>lower RSSI values give less information.</li>
<li>Open spaces will have different WiFi characteristics than tight spaces</li>
<li>WiFi signals can be blocked by thick walls</li>
<li>A small number of MACs may be from moving emitters (people running a Hot-Spot on their phone)</li>
</ul>
<h2 id="13-loading-the-data">1.3 Loading the data</h2>
<p>The data is assembled as three files for you.</p>
<p>The <code>task1_fingerprints.json</code> contains all the fingerprint information for the problem. That is each entry represents a real scan of the WiFi emitters in an area of the mall. You will find that the same MAC addresses will be present in many of the fingerprints.</p>
<p>The <code>task1_train.csv</code> contains the valid training pairs to help you design/train your algorithm. Each <code>id1-id2</code> pair has a labelled ground truth distance (in metres) and each id corresponds to a fingerprints from <code>task1_fingerprints.json</code>.</p>
<p>The <code>task1_test.csv</code> is the same format as <code>task1_train.csv</code> but doesn&rsquo;t have the displacements included. These are what we would like you to predict using the raw fingerprint information.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">csv</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">path_to_data</span> <span class="o">=</span> <span class="s2">&#34;for_contestants&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">,</span><span class="s2">&#34;task1_fingerprints.json&#34;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">fps</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">,</span><span class="s2">&#34;task1_train.csv&#34;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">train_data</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">train_h</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">train_h</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">pair</span><span class="p">[</span><span class="s1">&#39;id1&#39;</span><span class="p">],</span><span class="n">pair</span><span class="p">[</span><span class="s1">&#39;id2&#39;</span><span class="p">],</span><span class="nb">float</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s1">&#39;displacement&#39;</span><span class="p">])])</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">,</span><span class="s2">&#34;task1_test.csv&#34;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">test_h</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">test_ids</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">test_h</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">test_ids</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">pair</span><span class="p">[</span><span class="s1">&#39;id1&#39;</span><span class="p">],</span><span class="n">pair</span><span class="p">[</span><span class="s1">&#39;id2&#39;</span><span class="p">]])</span>
</span></span></code></pre></div><h3 id="131-the-ideal-model">1.3.1 The Ideal Model</h3>
<p>Ultimately, the ideal model should be able to find an exact mapping between the highly dimensional fingerprint space (1 fingerprint can contain many measurements) and the 1 dimensional distance space. It can be useful to plot the pdr distance (from the training data) against some computed similarity metric to see if the metric reveals an obvious trend. High similarity should correlate with low distance.</p>
<p>Below is one distance metric that we use internally for this task. You can see that even for this metric, we have a considerable amount of noise.</p>
<p><strong>Due to this level of noise, our scoring metric for task 1 will be biased towards precision over recall</strong></p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="images/sim_vs_pdr.png" alt="sim_vs_pdr.png" loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<h2 id="14-submission">1.4 Submission</h2>
<p>Your submission should use the <strong>exact</strong> ids from the <em>test1_test.csv</em> file and should populate the third (currently empty) displacement column with your estimated distance (in metres) for that fingerprint pair.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_distance_function</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span> <span class="n">fp2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">output_data</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&#34;id1&#34;</span><span class="p">,</span> <span class="s2">&#34;id2&#34;</span><span class="p">,</span> <span class="s2">&#34;displacement&#34;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">id1</span><span class="p">,</span> <span class="n">id2</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">test_ids</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">fp1</span> <span class="o">=</span> <span class="n">fps</span><span class="p">[</span><span class="n">id1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">fp2</span> <span class="o">=</span> <span class="n">fps</span><span class="p">[</span><span class="n">id2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">distance_estimate</span> <span class="o">=</span> <span class="n">my_distance_function</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span><span class="n">fp2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">output_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">id1</span><span class="p">,</span><span class="n">id2</span><span class="p">,</span><span class="n">distance_estimate</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;MySubmission.csv&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">output_data</span><span class="p">)</span>
</span></span></code></pre></div><h1 id="________________________________">________________________________</h1>
<center> <h1>TASK 1 OUR SOLUTION</h1> </center> 
<p>The steps in the first task can be summarized as follows.</p>
<ul>
<li>Input files are read, using those files :
<ul>
<li>Training data feature extraction is performed.</li>
<li>Testing data feature extraction is performed.</li>
</ul>
</li>
<li>At the end of feature extraction, two new dataset with 11 features is created (training data contains real distance, testing data does not).</li>
<li>An artificial neural network (ANN) is created and trained with the Training data.</li>
<li>Using the trained model, the test data is labelled and the submission file is created.</li>
</ul>
<p>These steps are illustrated in the image below.</p>
<img src="images/task-1.png" alt="drawing" width="1000"/>
<h2 id="11-installing-modules">1.1 Installing modules</h2>
<p>We used <a href="https://www.python.org/downloads/" target="_blank" rel="noopener">Python 3.6.5</a> to create the application file. We included some additional modules that were not included in the example file given at the start of the competition. These modules can be listed as:</p>
<table>
<thead>
<tr>
<th>Molules</th>
<th>Task</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://www.tensorflow.org/" target="_blank" rel="noopener"> tensorflow </a></td>
<td>Deep Learning</td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/install.html" target="_blank" rel="noopener"> Pandas  </a></td>
<td>Data Analysis</td>
</tr>
<tr>
<td><a href="https://scipy.org/" target="_blank" rel="noopener"> SciPy </a></td>
<td>Distance Computing</td>
</tr>
</tbody>
</table>
<p>We started with the installation of these modules as the first step.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## 1.1 Installing modules</span>
</span></span><span class="line"><span class="cl"><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">tensorflow</span><span class="o">==</span><span class="mf">2.6.2</span>
</span></span><span class="line"><span class="cl"><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">scipy</span>
</span></span><span class="line"><span class="cl"><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pandas</span>
</span></span></code></pre></div><h2 id="12--setting-random-seeds">1.2  Setting Random Seeds</h2>
<p>In this step, we fixed the related random seed to be used in order to obtain repeatable results. In this way, we have provided a deterministic path where we get the same result in every run. However, according to our observations, the results obtained with different computers may differ slightly (±1%)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## 1.2  Setting Random Seeds</span>
</span></span><span class="line"><span class="cl"><span class="n">seed_value</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYTHONHASHSEED&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
</span></span><span class="line"><span class="cl"><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">session_conf</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">ConfigProto</span><span class="p">(</span><span class="n">intra_op_parallelism_threads</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inter_op_parallelism_threads</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">get_default_graph</span><span class="p">(),</span> <span class="n">config</span><span class="o">=</span><span class="n">session_conf</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="13-loading-the-data-1">1.3 Loading the data</h2>
<p>In this section, we load the data that we will use. We took the code and explanations from the sample file given (<code>Task1-IPS-Challenge-2021.ipynb</code>).</p>
<p>The <code>task1_fingerprints.json</code> contains all the fingerprint information for the problem. That is each entry represents a real scan of the WiFi emitters in an area of the mall. You will find that the same MAC addresses will be present in many of the fingerprints.</p>
<p>The <code>task1_train.csv</code> contains the valid training pairs to help you design/train your algorithm. Each <code>id1-id2</code> pair has a labelled ground truth distance (in metres) and each id corresponds to a fingerprints from <code>task1_fingerprints.json</code>.</p>
<p>The <code>task1_test.csv</code> is the same format as <code>task1_train.csv</code> but doesn&rsquo;t have the displacements included.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## 1.3 Loading the data</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">csv</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">path_to_data</span> <span class="o">=</span> <span class="s2">&#34;for_contestants&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">,</span><span class="s2">&#34;task1_fingerprints.json&#34;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">fps</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">,</span><span class="s2">&#34;task1_train.csv&#34;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">train_data</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">train_h</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">train_h</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">train_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">pair</span><span class="p">[</span><span class="s1">&#39;id1&#39;</span><span class="p">],</span><span class="n">pair</span><span class="p">[</span><span class="s1">&#39;id2&#39;</span><span class="p">],</span><span class="nb">float</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="s1">&#39;displacement&#39;</span><span class="p">])])</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">,</span><span class="s2">&#34;task1_test.csv&#34;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">test_h</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">test_ids</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">test_h</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">test_ids</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">pair</span><span class="p">[</span><span class="s1">&#39;id1&#39;</span><span class="p">],</span><span class="n">pair</span><span class="p">[</span><span class="s1">&#39;id2&#39;</span><span class="p">]])</span>
</span></span></code></pre></div><pre><code>879824it [05:16, 2778.31it/s]  
5160445it [01:00, 85269.27it/s] 
</code></pre>
<h2 id="14-feature-extraction">1.4 Feature Extraction</h2>
<p>In this step, we perform feature extraction using two functions. <code>feature_extraction_file</code> function simply pulls the relevant values of the fingerprints (in pairs) from the JSON file and sends them to the <code>feature_extraction</code>  function to do the calculations .</p>
<p>In the <code>feature_extraction</code> function, if these two fingerprints are different from each other in terms of size and the devices they contain, all the devices included in the two fingerprints are brought together to form a common sequence without repeating. In each array, we make these two arrays identical (in terms of devices they include) by assigning the value 0 to the non-corresponding devices. This process is explained with an example in the following image.</p>
<img src="images/fp.png" alt="The process of making two different fingerprints similar" width="600"/>
<p>The distance between these two fingerprints, which are made similar, is calculated using 11 different methods[1]. These methods are:</p>
<ul>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.braycurtis.html" target="_blank" rel="noopener">Bray-Curtis distance</a></li>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.canberra.html" target="_blank" rel="noopener">Canberra distance</a></li>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.chebyshev.html" target="_blank" rel="noopener">Chebyshev distance</a></li>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.cityblock.html" target="_blank" rel="noopener">City Block (Manhattan) distance</a></li>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.correlation.html" target="_blank" rel="noopener">Correlation distance </a></li>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.cosine.html" target="_blank" rel="noopener">Cosine distance</a></li>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.euclidean.html" target="_blank" rel="noopener">Euclidean distance  </a></li>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.jensenshannon.html" target="_blank" rel="noopener">Jensen-Shannon distance </a></li>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.minkowski.html" target="_blank" rel="noopener">Minkowski distance</a></li>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.sqeuclidean.html" target="_blank" rel="noopener">Squared Euclidean distance</a></li>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.wminkowski.html" target="_blank" rel="noopener">Weighted Minkowski distance </a></li>
</ul>
<p>Then, these values are directed to the <code>feature_extraction_file</code> function and saved as a CSV file within this function. In other words, fingerprints of various sizes turn into an 11-feature CSV file as a result of this process. The model to be used is trained and tested with these newly created features.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## 1.4 Feature Extraction</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">feature_extraction_file</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">flag</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">features</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&#34;braycurtis&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;canberra&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;chebyshev&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;cityblock&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;correlation&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;cosine&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;euclidean&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;jensenshannon&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;minkowski&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;sqeuclidean&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;wminkowski&#34;</span><span class="p">,</span> <span class="s2">&#34;real&#34;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">((</span><span class="n">data</span><span class="p">),</span> <span class="n">position</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">fp1</span> <span class="o">=</span> <span class="n">fps</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">        <span class="n">fp2</span> <span class="o">=</span> <span class="n">fps</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">        <span class="n">feature</span><span class="o">=</span><span class="n">feature_extraction</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span><span class="n">fp2</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">feature</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span><span class="n">feature</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">features</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="c1">#print(features)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## 1.4 Feature Extraction</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">feature_extraction</span><span class="p">(</span><span class="n">fp1</span><span class="p">,</span><span class="n">fp2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">mac</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">fp1</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="n">fp2</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">    <span class="n">mac</span> <span class="o">=</span> <span class="p">{</span> <span class="n">i</span> <span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mac</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">f1</span><span class="o">=</span><span class="n">mac</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">f2</span><span class="o">=</span><span class="n">mac</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">fp1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">fp1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">fp2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f2</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">fp2</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>        
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">f1</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">f1</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">f2</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">f2</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">braycurtis</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">braycurtis</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">canberra</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">canberra</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">chebyshev</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">chebyshev</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cityblock</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">cityblock</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">correlation</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cosine</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">cosine</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">euclidean</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">euclidean</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">jensenshannon</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">jensenshannon</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">minkowski</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">minkowski</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sqeuclidean</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">sqeuclidean</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">wminkowski</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">wminkowski</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f1</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">output_data</span><span class="o">=</span><span class="p">[</span><span class="n">braycurtis</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">canberra</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">chebyshev</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">cityblock</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">correlation</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">cosine</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">euclidean</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">jensenshannon</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">minkowski</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">sqeuclidean</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">wminkowski</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">output_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">x</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">output_data</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">output_data</span>
</span></span></code></pre></div><h2 id="15-model">1.5 Model</h2>
<p>In this task, there is fingerprints scans which have RRSI signals from WiFi emitters surroundings in the mall. First challange wants us to estimate the distance between two fingerprints scans which is a regression task. We used ANN (Artificial Neural Networks) which is inspired by biological neural network. ANN consists of three layers; input layer, hidden layers (more than one) and output layer. ANN starts with input layer which includes the training data (with features), passes the data to the first hidden layer where the data is computed by the first hidden layer&rsquo;s weights. In hidden layers, there is an iteration of calculation of weights to the inputs and then apply them an activation function [2]. As our problem is regression, our last layer is a single output neuron: its output is the predicted the distances between pairs of fingerprint scans. Our first hidden layer has 64 and the second has 128 neurons. The all architecture of this model is shared as follows.
<img src="images/model.png" alt="The process of making two different fingerprints similar" width="400"/></p>
<p>We perform  deep learning using two functions.The <code>create_model</code> function shapes the training data to train the model and determines the structure of the model. The  <code>model_features</code> function produces a model with the specified structure. The created model is saved to be used after being trained by the <code>create_model</code> function.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## 1.5 Model </span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">scipy.spatial</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>
</span></span><span class="line"><span class="cl"><span class="c1">#from keras.utils.vis_utils import plot_model</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">model_features</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ii</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dense_1&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dense_2&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dense_output&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#plot_model(model, to_file=&#39;model_plot.png&#39;, show_shapes=True, show_layer_names=True)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#print(model.get_config())</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">model</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">create_model</span> <span class="p">(</span><span class="n">name</span><span class="p">):</span>     
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">X</span> <span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="n">X_train</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">y_train</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">=</span><span class="n">model_features</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span><span class="mi">128</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="c1">#,batch_size=1)</span>
</span></span><span class="line"><span class="cl">    <span class="n">loss</span><span class="o">=</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">val_loss</span><span class="o">=</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">]</span>    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">my_xticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">loss</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_xticks</span><span class="p">,</span><span class="n">loss</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span> <span class="s2">&#34;train&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_xticks</span><span class="p">,</span><span class="n">val_loss</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span> <span class="s2">&#34;val&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&#34;Scores &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&#34;Loss&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&#34;Epoch&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">])</span> 
</span></span><span class="line"><span class="cl">    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">madelname</span><span class="o">=</span><span class="s2">&#34;./THEMODEL&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">madelname</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Model Created!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span></code></pre></div><h2 id="16-checking-the-inputs">1.6 Checking the inputs</h2>
<p>This function checks if the training and testing data have gone through feature extraction. If they have not, it creates these files and the model by calling the corresponding functions. After handling the model and all feature extraction, it formats the test data to produce the final results.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## 1.6 Checking the inputs</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">inf</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">nan</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">create_new_files</span><span class="p">(</span><span class="n">train</span><span class="p">,</span><span class="n">test</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">model_path</span><span class="o">=</span><span class="s2">&#34;./THEMODEL/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_train_file</span><span class="o">=</span><span class="s1">&#39;new_train_features.csv&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">my_test_file</span><span class="o">=</span><span class="s1">&#39;new_test_features.csv&#39;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">my_train_file</span><span class="p">)</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span>  
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Please wait! Training data feature extraction is in progress...</span><span class="se">\n</span><span class="s2">it will take about 10 minutes&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">feature_extraction_file</span><span class="p">(</span><span class="n">train</span><span class="p">,</span><span class="n">my_train_file</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;TThe training feature extraction completed!!!&#34;</span><span class="p">)</span>       
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">my_test_file</span><span class="p">)</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span> 
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Please wait! Testing data feature extraction is in progress...</span><span class="se">\n</span><span class="s2">it will take about 100-120 minutes&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">feature_extraction_file</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="n">my_test_file</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;The testing feature extraction completed!!!&#34;</span><span class="p">)</span>           
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span>  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span>  
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Please wait! Creating the deep learning model...</span><span class="se">\n</span><span class="s2">it will take about 10 minutes&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">create_model</span><span class="p">(</span><span class="n">my_train_file</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;The model file created!!!</span><span class="se">\n\n\n</span><span class="s2">&#34;</span><span class="p">)</span>   
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">my_test_file</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">X_train</span> <span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="n">X_train</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">y_train</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">    <span class="n">predicted</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Please wait! Creating resuşts... &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">predicted</span>
</span></span></code></pre></div><h2 id="17-submission">1.7 Submission</h2>
<p>This step triggers feature extraction and model creation processes and allows all processes to begin. So, using the IDs from the <code>test1_test.csv</code> file it fills the third (displacement) column with the estimated distance for this fingerprint pairs and it saves this file in the directory with the name <code>TASK1-MySubmission.csv</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## 1.7 Submission </span>
</span></span><span class="line"><span class="cl"><span class="n">distance_estimate</span> <span class="o">=</span> <span class="n">create_new_files</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span><span class="n">test_ids</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">count</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">output_data</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&#34;id1&#34;</span><span class="p">,</span> <span class="s2">&#34;id2&#34;</span><span class="p">,</span> <span class="s2">&#34;displacement&#34;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">id1</span><span class="p">,</span> <span class="n">id2</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">test_ids</span><span class="p">):</span>   
</span></span><span class="line"><span class="cl">    <span class="n">output_data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">id1</span><span class="p">,</span><span class="n">id2</span><span class="p">,</span><span class="n">distance_estimate</span><span class="p">[</span><span class="n">count</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span><span class="o">+=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Process finished. Preparing result file ...&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;TASK1-MySubmission.csv&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">output_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;The results are ready.</span><span class="se">\n</span><span class="s2"> See MySubmission.csv&#34;</span><span class="p">)</span>  
</span></span></code></pre></div><pre><code>Please wait! Creating the deep learning model...
it will take about 10 minutes
Model: &quot;sequential_3&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_1 (Dense)              (None, 64)                768       
_________________________________________________________________
dense_2 (Dense)              (None, 128)               8320      
_________________________________________________________________
dense_output (Dense)         (None, 1)                 129       
=================================================================
Total params: 9,217
Trainable params: 9,217
Non-trainable params: 0
_________________________________________________________________
Epoch 1/19
13748/13748 [==============================] - 30s 2ms/step - loss: 2007233.6250 - mae: 161.3013 - val_loss: 218.8822 - val_mae: 11.5630
Epoch 2/19
13748/13748 [==============================] - 27s 2ms/step - loss: 24832.6309 - mae: 53.9385 - val_loss: 123437.0859 - val_mae: 307.2885
Epoch 3/19
13748/13748 [==============================] - 26s 2ms/step - loss: 4028.0859 - mae: 29.9960 - val_loss: 3329.2024 - val_mae: 49.9126
Epoch 4/19
13748/13748 [==============================] - 27s 2ms/step - loss: 904.7919 - mae: 17.6284 - val_loss: 122.3358 - val_mae: 6.8169
Epoch 5/19
13748/13748 [==============================] - 25s 2ms/step - loss: 315.7050 - mae: 11.9098 - val_loss: 404.0973 - val_mae: 15.2033
Epoch 6/19
13748/13748 [==============================] - 26s 2ms/step - loss: 126.3843 - mae: 7.8173 - val_loss: 112.6499 - val_mae: 7.6804
Epoch 7/19
13748/13748 [==============================] - 27s 2ms/step - loss: 112.0149 - mae: 7.4220 - val_loss: 109.5987 - val_mae: 7.1964
Epoch 8/19
13748/13748 [==============================] - 26s 2ms/step - loss: 108.6342 - mae: 7.3271 - val_loss: 110.9016 - val_mae: 7.6862
Epoch 9/19
13748/13748 [==============================] - 26s 2ms/step - loss: 107.6721 - mae: 7.2827 - val_loss: 109.5083 - val_mae: 7.5235
Epoch 10/19
13748/13748 [==============================] - 27s 2ms/step - loss: 107.0110 - mae: 7.2290 - val_loss: 107.7498 - val_mae: 7.1105
Epoch 11/19
13748/13748 [==============================] - 29s 2ms/step - loss: 106.7296 - mae: 7.2158 - val_loss: 107.6115 - val_mae: 7.1178
Epoch 12/19
13748/13748 [==============================] - 26s 2ms/step - loss: 106.5561 - mae: 7.2039 - val_loss: 107.9937 - val_mae: 6.9932
Epoch 13/19
13748/13748 [==============================] - 26s 2ms/step - loss: 106.3344 - mae: 7.1905 - val_loss: 108.8941 - val_mae: 7.4530
Epoch 14/19
13748/13748 [==============================] - 27s 2ms/step - loss: 106.3188 - mae: 7.1927 - val_loss: 109.0832 - val_mae: 7.5309
Epoch 15/19
13748/13748 [==============================] - 27s 2ms/step - loss: 106.1150 - mae: 7.1829 - val_loss: 113.9741 - val_mae: 7.9496
Epoch 16/19
13748/13748 [==============================] - 26s 2ms/step - loss: 106.0676 - mae: 7.1788 - val_loss: 107.2984 - val_mae: 7.2192
Epoch 17/19
13748/13748 [==============================] - 27s 2ms/step - loss: 106.0614 - mae: 7.1733 - val_loss: 108.8553 - val_mae: 7.4640
Epoch 18/19
13748/13748 [==============================] - 28s 2ms/step - loss: 106.0113 - mae: 7.1790 - val_loss: 110.2068 - val_mae: 7.6562
Epoch 19/19
13748/13748 [==============================] - 27s 2ms/step - loss: 106.0519 - mae: 7.1791 - val_loss: 107.3276 - val_mae: 7.0981
</code></pre>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="images/output_17_1.png" alt="png" loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<pre><code>INFO:tensorflow:Assets written to: ./THEMODEL\assets
Model Created!
The model file created!!!



Please wait! Creating resuşts... 


100%|████████████████████████████████████████████████████████████████████| 5160445/5160445 [00:08&lt;00:00, 610910.29it/s]


Process finished. Preparing result file ...
The results are ready.
 See MySubmission.csv
</code></pre>
<h1 id="--------------------------">&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;</h1>
<center> <h1>TASK 2 QUESTION</h1> </center> 
## 2.1 Graph Clustering Introduction
<p>Given that we now have a metric for evaluating WiFi distance our next task is to seperate trajectories from a mall (a different mall to that used in the first challenge!) into the seperate floors that they belong in. You can do this in different ways, but we would strongly suggest a graph clustering approach.</p>
<p>Consider each WiFi fingerprint in the data as a node in a graph and that we can form an edge with other fingerprints in the graph by evaluating the similarity any two fingerprints. We can assign a high weight to edges where we have a high similarity between fingerprints and a low weight (or no edge) between those that are not similar. In theory, a perfectly accurate similarity metric would trivially seperate floors as we could exclude all edges of greater than around 4 metres (roughly the height of 1 storey of a building). In reality it is likely that we will make false edges between floors and we will need to somehow break these edges.</p>
<p>Let&rsquo;s start with a simple example. Consider the graph below where the node colours show the true floor classification of the fingerprint and the edges reflect that we believe these nodes exist on the same floor. For this exercise we have pre-labelled each edge with its &ldquo;Betweenness Score&rdquo;, a metric that counts how many times this edge is walked by taking the shortest path between any two nodes in the graph. Typically, this will reveal edges that indicate high connectivity and may be candidates for removal.</p>
<p>In this example, use the edge-betweenness score to detect the graph communties. Return a list of lists where each sublist contains the node ids of the communities. Note this is just to help your understanding of the problem and does not count for the actual solution.</p>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="images/trigraph_2.png" alt="trigraph_2.png" loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">detect_communities</span><span class="p">(</span><span class="n">Graph</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1">## This function should return a list of lists containing </span>
</span></span><span class="line"><span class="cl">    <span class="c1">## the node ids of the communities that you have detected.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">eb_score</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">edge_betweenness_centrality</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">metrics</span> <span class="kn">import</span> <span class="n">check_result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_adjlist</span><span class="p">(</span><span class="s2">&#34;graph.adjlist&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">communities</span> <span class="o">=</span> <span class="n">detect_communities</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">check_result</span><span class="p">(</span><span class="n">communities</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Correct!&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Try again&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="22-full-mall-graph-clustering">2.2 Full Mall Graph Clustering</h2>
<h3 id="train">Train</h3>
<p>The sample training data for this problem is a set of 106981 fingerprints (<code>task2_train_fingerprints.json</code>) and some edges between them. We have provided files that indicate three different edge types, all of which should be treated differently.</p>
<p><code>task2_train_steps.csv</code> indicates edges that connect subsequent steps within a trajectory. These edges should be highly trusted as they indicate a certainty that two fingerprints were recorded from the same floor.</p>
<p><code>task2_train_elevations.csv</code> indicate the opposite of the steps. These elevations indicate that the fingerprints are almost definitely from a different floor. You can thus extrapolate that if fingerprint $N$ from trajectory $n$ is on a different floor to fingerprint $M$ from trajectory $m$, then all other fingerprints in both trajectories $m$ and $n$ must also be on seperate floors.</p>
<p><code>task2_train_estimated_wifi_distances.csv</code> are the pre-computed distances that we have calculated using our own distance metric. This metric is imperfect and as such we know that many of these edges will be incorrect (i.e. they will connect two floors together). We suggest that initially you use the edges in this file to construct your initial graph and compute some solution. However, if you get a high score on task1 then you might consider computing your own wifi distances to build a graph.</p>
<p>Your graph can be at one of two levels of detail, either trajectory level or fingerprint level, you can choose what representation you want to use, but ultimately we want to know the <strong>trajectory clusters</strong>. Trajectory level would have every node as a trajectory and edges between nodes would occur if fingerprints in their trajectories had high similiraty. Fingerprint level would have each fingerprint as a node. You can lookup the trajectory id of the fingerprint using the <code>task2_train_lookup.json</code> to convert between representations.</p>
<p>To help you debug and train your solution we have provided a ground truth for some of the trajectories in <code>task2_train_GT.json</code>. In this file the keys are the trajectory ids (the same as in <code>task2_train_lookup.json</code>) and the values are the real floor id of the building.</p>
<h3 id="test">Test</h3>
<p>The test set is the exact same format as the training set (for a seperate building, we weren&rsquo;t going to make it that easy ;) ) but we haven&rsquo;t included the equivalent ground truth file. This will be withheld to allow us to score your solution.</p>
<p>Points to consider</p>
<ul>
<li>When doing this on real data we do not know the exact number of floors to expect, so your model will need to decide this for itself as well. For this data, do not expect to find more than 20 floors or less than 3 floors.</li>
<li>Sometimes in balcony areas the similarity between fingerprints on different floors can be deceivingly high. In these cases it may be wise to try to rely on the graph information rather than the individual similarity (e.g. what is the similarity of the other neighbour nodes to this candidate other-floor node?)</li>
<li>To the best of our knowledge there are no outlier fingerprints in the data that do not belong to the building. Every fingerprint belongs to a floor</li>
</ul>
<h2 id="23-loading-the-data">2.3 Loading the data</h2>
<p>In this section we will provide some example code to open the files and construct both types of graph.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">csv</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">path_to_data</span> <span class="o">=</span> <span class="s2">&#34;task2_for_participants/train&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">,</span><span class="s2">&#34;task2_train_estimated_wifi_distances.csv&#34;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">wifi</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">reader</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">wifi</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;id1&#39;</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;id2&#39;</span><span class="p">],</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;estimated_distance&#39;</span><span class="p">])])</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">,</span><span class="s2">&#34;task2_train_elevations.csv&#34;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">elevs</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">reader</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">elevs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;id1&#39;</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;id2&#39;</span><span class="p">]])</span>        
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">,</span><span class="s2">&#34;task2_train_steps.csv&#34;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">steps</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">reader</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;id1&#39;</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;id2&#39;</span><span class="p">],</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;displacement&#39;</span><span class="p">])])</span> 
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="n">fp_lookup_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">,</span><span class="s2">&#34;task2_train_lookup.json&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">gt_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">,</span><span class="s2">&#34;task2_train_GT.json&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fp_lookup_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">fp_lookup</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">gt_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">gt</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   
</span></span></code></pre></div><h3 id="fingerprint-graph">Fingerprint graph</h3>
<p>This is one way to construct the fingerprint-level graph, where each node in the graph is a fingerprint. We have added edge weights that correspond to the estimated/true distances from the wifi and pdr edges respectively. We have also added elevation edges to indicate this relationship. You might want to explicitly enforce that there are <em>none</em> of these edges (or any valid elevation edge between trajectories) when developing your solution.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">id1</span><span class="p">,</span><span class="n">id2</span><span class="p">,</span><span class="n">dist</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="s2">&#34;s&#34;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">dist</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">id1</span><span class="p">,</span><span class="n">id2</span><span class="p">,</span><span class="n">dist</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">wifi</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">dist</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">id1</span><span class="p">,</span><span class="n">id2</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">elevs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">,</span> <span class="n">ty</span> <span class="o">=</span> <span class="s2">&#34;e&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="trajectory-graph">Trajectory graph</h3>
<p>The trajectory graph is arguably not as simple as you need to think of a way to represent many wifi connections between trajectories. In the example graph below we just take the mean distance as a weight, but is this really the best representation?</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">B</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get all the trajectory ids from the lookup</span>
</span></span><span class="line"><span class="cl"><span class="n">valid_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">fp_lookup</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">valid_nodes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">B</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Either add an edge or append the distance to the edge data</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">id1</span><span class="p">,</span><span class="n">id2</span><span class="p">,</span><span class="n">dist</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">wifi</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">B</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id1</span><span class="p">)],</span> <span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id2</span><span class="p">)]):</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">B</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id1</span><span class="p">)],</span> 
</span></span><span class="line"><span class="cl">                   <span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id2</span><span class="p">)],</span> 
</span></span><span class="line"><span class="cl">                   <span class="n">ty</span> <span class="o">=</span> <span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="p">[</span><span class="n">dist</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">B</span><span class="p">[</span><span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id1</span><span class="p">)]][</span><span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id2</span><span class="p">)]][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="c1"># Compute the mean edge weight</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">B</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">B</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="c1"># If you have made a wifi connection between trajectories with an elev, delete the edge</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">id1</span><span class="p">,</span><span class="n">id2</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">elevs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">B</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id1</span><span class="p">)],</span> <span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id2</span><span class="p">)]):</span>
</span></span><span class="line"><span class="cl">        <span class="n">B</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id1</span><span class="p">)],</span> 
</span></span><span class="line"><span class="cl">                      <span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id2</span><span class="p">)])</span>
</span></span></code></pre></div><h2 id="23-submission">2.3 Submission</h2>
<p>Your submission should be a csv file where trajectories that you believe to be on the same floor have their index on the same row seperated by commas. Each new cluster will be entered on a new row.</p>
<p>For example, see the below random entry.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">random_data</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_clusters</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">random_data</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">traj</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">fp_lookup</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
</span></span><span class="line"><span class="cl">    <span class="n">cluster</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_clusters</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">random_data</span><span class="p">[</span><span class="n">cluster</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;MyRandomSubmission.csv&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">csv_writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">csv_writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">random_data</span><span class="p">)</span>
</span></span></code></pre></div><center> <h1>TASK 2 OUR SOLUTION</h1> </center> 
<p>The steps in task 2 can be summarized as follows:</p>
<ul>
<li>The inputs are read and a graphic file is created from them.</li>
<li>The graphic file is saved as an adjacency list.</li>
<li>The adjacency list is vectorized using <code>Node2vec</code>.</li>
<li>IDs are grouped by the k-means algorithm according to the vectors.</li>
<li>The results file (<code>TASK2-Mysubmission.csv</code>) is prepared according to the trajectory of IDs .</li>
</ul>
<p>These steps are illustrated in the image below.</p>
<img src="images/kmeans.png" alt="TASK-2 Steps" width="1000"/>
<h2 id="21-installing-modules">2.1 Installing modules</h2>
<p>We used <a href="https://www.python.org/downloads/" target="_blank" rel="noopener">Python 3.6.5</a> to create the application file. We included some additional modules that were not included in the example file given at the start of the competition. These modules can be listed as:</p>
<table>
<thead>
<tr>
<th>Molules</th>
<th>Task</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://scikit-learn.org/stable/install.html" target="_blank" rel="noopener"> scikit-learn </a></td>
<td>Machine Learning &amp; Data Preparation</td>
</tr>
<tr>
<td><a href="https://snap.stanford.edu/node2vec/" target="_blank" rel="noopener"> node2vec  </a></td>
<td>Scalable Feature Learning for Networks</td>
</tr>
<tr>
<td><a href="https://numpy.org/" target="_blank" rel="noopener"> numpy </a></td>
<td>Mathematical Operations</td>
</tr>
</tbody>
</table>
<p>We started with the installation of these modules as the first step.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## 2.1 Installing modules</span>
</span></span><span class="line"><span class="cl"><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">node2vec</span>
</span></span><span class="line"><span class="cl"><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">scikit</span><span class="o">-</span><span class="n">learn</span>
</span></span><span class="line"><span class="cl"><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">numpy</span> 
</span></span></code></pre></div><h2 id="22--setting-random-seeds">2.2  Setting Random Seeds</h2>
<p>In this step, we fixed the related random seed to be used in order to obtain repeatable results. In this way, we have provided a deterministic path where we get the same result in every run. However, according to our observations, the results obtained on different computers may differ slightly (±1%)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## 2.2  Setting Random Seeds</span>
</span></span><span class="line"><span class="cl"><span class="n">seed_value</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYTHONHASHSEED&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed_value</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="23-loading-the-data-1">2.3 Loading the data</h2>
<p>In this section, the files given for the test data are loaded.</p>
<ul>
<li><code>wifi</code>  variable takes IDs and weights from the  <code>task2_test_estimated_wifi_distances.csv</code>.</li>
<li><code>steps</code>  variable takes IDs and weights from file <code>task2_test_steps.csv</code>.</li>
<li><code>elevs</code>  variable takes IDs from file  <code>task2_test_elevations.csv</code>.</li>
<li><code>fp_lookup</code>  variable gets  IDs and trajectories from the  <code>task2_test_lookup.json</code> file.</li>
</ul>
<p>We did not prefer the method of recalculating the estimated distances given in wifi with the model we obtained in Task1, because the results we obtained from this process did not make a significant difference. That&rsquo;s why we didn&rsquo;t use the <code>task2_test_fingerprints.json</code> file in our ultimate work.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## 2.3 Loading the data  </span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">csv</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">path_to_data</span> <span class="o">=</span> <span class="s2">&#34;task2_for_participants/test&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">,</span><span class="s2">&#34;task2_test_estimated_wifi_distances.csv&#34;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">wifi</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">reader</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">wifi</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;id1&#39;</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;id2&#39;</span><span class="p">],</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;estimated_distance&#39;</span><span class="p">])])</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">,</span><span class="s2">&#34;task2_test_elevations.csv&#34;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">elevs</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">reader</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">elevs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;id1&#39;</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;id2&#39;</span><span class="p">]])</span>        
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">,</span><span class="s2">&#34;task2_test_steps.csv&#34;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">steps</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">reader</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;id1&#39;</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;id2&#39;</span><span class="p">],</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="s1">&#39;displacement&#39;</span><span class="p">])])</span> 
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="n">fp_lookup_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">,</span><span class="s2">&#34;task2_test_lookup.json&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fp_lookup_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">fp_lookup</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>3773297it [00:19, 191689.25it/s]
2767it [00:00, 52461.27it/s]
139537it [00:00, 180082.01it/s]
</code></pre>
<h2 id="23-generating-the-trajectory--graph">2.3 Generating the Trajectory  graph.</h2>
<p>We take the average distance as the weight when creating the Trajectory graph. We used the example given for Task 2 (<code>Task2-IPS-Challenge-2021.ipynb</code>) for this process. We saved the resulting graph (<code>B</code>) as an adjacency list in the directory (as <code>my.adjlist</code>).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## 2.3 Generating the Trajectory  graph. </span>
</span></span><span class="line"><span class="cl"><span class="n">B</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get all the trajectory ids from the lookup</span>
</span></span><span class="line"><span class="cl"><span class="n">valid_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">fp_lookup</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">valid_nodes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">B</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Either add an edge or append the distance to the edge data</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">id1</span><span class="p">,</span><span class="n">id2</span><span class="p">,</span><span class="n">dist</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">wifi</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">B</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id1</span><span class="p">)],</span> <span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id2</span><span class="p">)]):</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">B</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id1</span><span class="p">)],</span> 
</span></span><span class="line"><span class="cl">                   <span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id2</span><span class="p">)],</span> 
</span></span><span class="line"><span class="cl">                   <span class="n">ty</span> <span class="o">=</span> <span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="p">[</span><span class="n">dist</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">B</span><span class="p">[</span><span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id1</span><span class="p">)]][</span><span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id2</span><span class="p">)]][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="c1"># Compute the mean edge weight</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">B</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">B</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="c1"># If you have made a wifi connection between trajectories with an elev, delete the edge</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">id1</span><span class="p">,</span><span class="n">id2</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">elevs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">B</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id1</span><span class="p">)],</span> <span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id2</span><span class="p">)]):</span>
</span></span><span class="line"><span class="cl">        <span class="n">B</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id1</span><span class="p">)],</span> 
</span></span><span class="line"><span class="cl">                      <span class="n">fp_lookup</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">id2</span><span class="p">)])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">nx</span><span class="o">.</span><span class="n">write_adjlist</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="s2">&#34;my.adjlist&#34;</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>100%|████████████████████████████████████████████████████████████████████| 3773297/3773297 [00:27&lt;00:00, 135453.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████| 2767/2767 [00:00&lt;?, ?it/s]
</code></pre>
<h2 id="24-converting-nodes-to-vectors">2.4 Converting nodes to vectors</h2>
<p>Before giving the adjacency list as input to the machine learning algorithms, we convert the nodes to vector. In our work we used Node2vec as a graph embedding algorithm methodology proposed by Grover&amp;Leskovec in 2016 [3]. Node2vec is a semi-supervised algorithm for feature learning of the nodes in the network. Node2vec is created based on the skip-gram technique, which is an NLP approach motivated on Distributional Structure concept.According to idea, if different words used in similar contexts they probably have a similar meaning and there is an obvious relationship between them. Skip-gram technique uses center word(input) to predict neighbours(output) while computing the probabilities of surroundings based on a given window size (contiguous sequence of items before of after the center), in other words N-grams. Unlike the NLP approach, Node2vec system is not fed with words which have a linear structure, but nodes and edges, which have a distributed graphical structure. This multidimensional structure makes embeddings complex and computationally expensive, but Node2vec uses negative sampling with optimizing stochastic gradient descent (SGD) to deal with it. In addition to this, The random walk approach is used to detect sample neighboring nodes of the source node in a nonlinear structure.</p>
<p>In our study, we first performed the vector representation of node relationships in low-dimensional space by modeling with node2vec from given distance of two nodes (weights). Then we used the output of Node2vec (graph embeddings), which has vectors of nodes, to feed traditional K-means clustering algorithm.</p>
<p>The parameters we use in Nod2vec can be listed as follows:</p>
<table>
<thead>
<tr>
<th>Hyperparameter</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>dimensions</td>
<td>32</td>
</tr>
<tr>
<td>walk_length</td>
<td>15</td>
</tr>
<tr>
<td>num_walks</td>
<td>100</td>
</tr>
<tr>
<td>workers</td>
<td>1</td>
</tr>
<tr>
<td>seed</td>
<td>0</td>
</tr>
<tr>
<td>window</td>
<td>10</td>
</tr>
<tr>
<td>min_count</td>
<td>1</td>
</tr>
<tr>
<td>batch_words</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>The Node2vec model takes the adjacency list as input and outputs a 32-size vector. In this part, the node.py file is created and run in the <code>Jupyter Notebook</code>. There are two reasons why it is preferable to run externally rather than in a Jupyter notebook cell.</p>
<ul>
<li>It allows fixing the random seed of the node2vec module. Thus, it ensures repeatability by providing the same result in different runs.</li>
<li><code>Node2vec</code> is a very computationally expensive method, RAM overflow error is quite possible if run inside Jupyter notebook. Creating and running <code>Node2vec</code> model outside avoids this error.</li>
</ul>
<p>The cell below creates the file named node.py. This file creates the node2vec model. This model takes the the adjacency list (<code>my.adjlist</code>) as input and creates a 32-dimensional vector file as output (<code>vectors.emb</code>).</p>
<p><strong>Important! The code below should be run in Linux distributions (Tested in Google colab and Ubuntu).</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># 2.4 Converting nodes to vectors</span>
</span></span><span class="line"><span class="cl"><span class="c1"># A folder named tmp is created. This folder is essential for the node2vec model to use less RAM.</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&#34;tmp&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&#34;tmp&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span> <span class="p">(</span><span class="s2">&#34;The folder could not be created!</span><span class="se">\n</span><span class="s2"> Please manually create the </span><span class="se">\&#34;</span><span class="s2">tmp</span><span class="se">\&#34;</span><span class="s2"> folder in the directory&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">node</span><span class="o">=</span><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2"># importing related modules
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">from node2vec import Node2Vec
</span></span></span><span class="line"><span class="cl"><span class="s2">import networkx as nx
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">#importing  adjacency list file as B
</span></span></span><span class="line"><span class="cl"><span class="s2">B = nx.read_adjlist(&#34;my.adjlist&#34;)
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">seed_value=0
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2"># Specifying the input and hyperparameters of the node2vec model
</span></span></span><span class="line"><span class="cl"><span class="s2">node2vec = Node2Vec(B, dimensions=32, walk_length=15, num_walks=100, workers=1,seed=seed_value,temp_folder = &#39;./tmp&#39;)  
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">#Assigning/specifying random seeds
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">import os
</span></span></span><span class="line"><span class="cl"><span class="s2">os.environ[&#39;PYTHONHASHSEED&#39;]=str(seed_value)
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">import random
</span></span></span><span class="line"><span class="cl"><span class="s2">random.seed(seed_value)
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">import numpy as np
</span></span></span><span class="line"><span class="cl"><span class="s2">np.random.seed(seed_value)
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2"># creation of the model
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">model = node2vec.fit(window=10, min_count=1, batch_words=4,seed=seed_value)   
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2"># saving the output vector
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">model.wv.save_word2vec_format(&#34;vectors.emb&#34;)
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2"># save the model
</span></span></span><span class="line"><span class="cl"><span class="s2">model.save(&#34;vectorMODEL&#34;)
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;node.py&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">!</span><span class="n">PYTHONHASHSEED</span><span class="o">=</span><span class="mi">0</span> <span class="n">python3</span> <span class="n">node</span><span class="o">.</span><span class="n">py</span> 
</span></span></code></pre></div><h2 id="24-reshaping-data">2.4 Reshaping data</h2>
<p>After our vector file is created, we read this file (<code>vectors.emb</code>). This file consists of 33 columns. The first column is the node number (IDs), and remain are vector values. By sorting the entire file by the first column, we return the nodes to their original order. Then we delete this ID column, which we will no longer use. So, we give the final shape of our data. Our data is ready to be used in machine learning applications.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># 2.4 Reshaping data</span>
</span></span><span class="line"><span class="cl"><span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&#34;vectors.emb&#34;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;shape of vector file: &#34;</span><span class="p">,</span><span class="n">vec</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">vec</span><span class="o">=</span><span class="n">vec</span><span class="p">[</span><span class="n">vec</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()];</span> 
</span></span><span class="line"><span class="cl"><span class="n">vec</span><span class="o">=</span><span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">vec</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">:</span><span class="n">vec</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span></span></code></pre></div><pre><code>shape of vector file:  (11162, 33)
[[ 9.1200000e+03  3.9031842e-01 -4.7147268e-01 ... -5.7490986e-02
   1.3059708e-01 -5.4280665e-02]
 [ 6.5320000e+03 -3.5591956e-02 -9.8558587e-01 ... -2.7217887e-02
   5.6435770e-01 -5.7787680e-01]
 [ 5.6580000e+03  3.5879680e-01 -4.7564098e-01 ... -9.7607370e-02
   1.5506668e-01  1.1333219e-01]
 ...
 [ 2.7950000e+03  1.1724627e-02  1.0272172e-02 ... -4.5596390e-04
  -1.1507459e-02 -7.6738600e-04]
 [ 4.3380000e+03  1.2865483e-02  1.2103912e-02 ...  1.6619096e-03
   1.3672550e-02  1.4605848e-02]
 [ 1.1770000e+03 -1.3707868e-03  1.5238028e-02 ... -5.9994194e-04
  -1.2986251e-02  1.3706315e-03]]
</code></pre>
<h2 id="25-determine-the-number-of-clusters">2.5 Determine the number of clusters</h2>
<p>Task-2 is a clustering problem. The premise that we need to decide when solving this problem is how many clusters we should divide into. For this, we tried different cluster numbers and compared the scores we got. The graph below shows the comparison of the number of clusters and the score obtained. As can be seen from this graph, the number of clusters increased continuously between 5 and 21, with some exception fluctuations, and stabilized after 21. For this reason, we focused on the number of clusters between 21 and 23 in our study.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># 2.5 Determine the number of clusters</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</span></span><span class="line"><span class="cl"><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&#34;whitegrid&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">agglom</span><span class="o">=</span><span class="p">[</span><span class="mf">24.69</span><span class="p">,</span><span class="mf">28.14</span><span class="p">,</span><span class="mf">28.14</span><span class="p">,</span><span class="mf">28.14</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mf">33.33</span><span class="p">,</span><span class="mf">40.88</span><span class="p">,</span><span class="mf">38.70</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mf">29.12</span><span class="p">,</span><span class="mf">45.85</span><span class="p">,</span><span class="mf">45.85</span><span class="p">,</span><span class="mf">48.00</span><span class="p">,</span><span class="mf">50.17</span><span class="p">,</span><span class="mf">57.83</span><span class="p">,</span><span class="mf">57.83</span><span class="p">,</span><span class="mf">57.83</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="n">agglom</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">24</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Number of clusters and performance relationship&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of clusters&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Score&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="images/output_34_0.png" alt="png" loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<h2 id="25--best-result">2.5  Best result</h2>
<p>Among the unsupervised machine learning methods we tried (such as <a href="https://scikit-learn.org/stable/modules/clustering.html#k-means" target="_blank" rel="noopener">K-means</a>,
<a href="https://scikit-learn.org/stable/modules/clustering.html#hierarchical-clustering" target="_blank" rel="noopener">Agglomerative Clustering</a>,
<a href="https://scikit-learn.org/stable/modules/clustering.html#affinity-propagation" target="_blank" rel="noopener">Affinity Propagation</a>,
<a href="https://scikit-learn.org/stable/modules/clustering.html#mean-shift" target="_blank" rel="noopener">Mean Shift</a>,
<a href="https://scikit-learn.org/stable/modules/clustering.html#spectral-clustering" target="_blank" rel="noopener">Spectral clustering</a>,
<a href="https://scikit-learn.org/stable/modules/clustering.html#dbscan" target="_blank" rel="noopener">DBSCAN</a>,
<a href="https://scikit-learn.org/stable/modules/clustering.html#optics" target="_blank" rel="noopener">OPTICS</a>,
<a href="https://scikit-learn.org/stable/modules/clustering.html#birch" target="_blank" rel="noopener">BIRCH</a>,
<a href="https://scikit-learn.org/stable/modules/clustering.html#mini-batch-k-means" target="_blank" rel="noopener">Mini-Batch K-Means</a>), we achieved the best results using k-Means with 23 clusters.</p>
<p>K-means is a clustering algorithm is one of the basic and traditional unsupervised machine learning techniques which make assumptions to find homogeneous or natural groups of elements (clusters) using unlabelled data. Clusters are to set of points (nodes in our data) grouped together which share particular similarities. K-means needs the target number of centroids which refers to how many groups the data should be divided into. Algorithm starts with group of randomly assigned centroids then continue iterations to find the best positions of them. The algorithm assigns the points/nodes to the appointed centroids using in-cluster the sum of squares of the member of points, this is continue updating and relocating[4]. In our example the number of centroids reflects the number of floors. It should be noted that this does not provide information about the order of the floors.</p>
<p>Below, k-Means application has been made for 23 clusters.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># 2.5  Best result</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">cluster</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ML_results</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">k_clusters</span> <span class="o">=</span> <span class="mi">23</span>
</span></span><span class="line"><span class="cl"><span class="n">algorithms</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="n">algorithms</span><span class="p">[</span><span class="s1">&#39;KMeans&#39;</span><span class="p">]</span> <span class="o">=</span><span class="n">cluster</span><span class="o">.</span><span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k_clusters</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">second</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">algorithms</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ML_results</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">second</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>KMeans(n_clusters=23, random_state=10) 1.082334280014038
</code></pre>
<h2 id="26-submission">2.6 Submission</h2>
<p>The output of the machine learning algorithm determines which cluster the fingerprints belong to. But what is required of us is to cluster the trajectories. Therefore, these fingerprints are converted to their trajectory counterparts using the <code>fp_lookup</code> variable. This output is processed into the <code>TASK2-Mysubmission.csv</code> file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1">## 2.6 Submission </span>
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="o">=</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">ii</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">fp_lookup</span><span class="o">.</span><span class="n">values</span><span class="p">())):</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">ML_results</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="n">ters</span><span class="o">=</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ters</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ters</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="n">ters</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ters</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"><span class="n">final_results</span><span class="o">=</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ters</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">final_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ters</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="n">name</span><span class="o">=</span><span class="s2">&#34;TASK2-Mysubmission.csv&#34;</span>    
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">csv_writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">csv_writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">final_results</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&#34;file is ready!&#34;</span><span class="p">)</span>
</span></span></code></pre></div><pre><code>TASK2-Mysubmission.csv file is ready!
</code></pre>
<hr>
<h1 id="references">References</h1>
<p>[1] P. Virtanen  and SciPy 1.0 Contributors. SciPy 1.0: Fundamental Algorithms for Scientific Computing in Python. Nature Methods, 17:261&ndash;272, 2020.</p>
<p>[2] A. Geron, Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow: Concepts, Tools, and Techniques to Build Intelligent Systems. O’Reilly Media, 2019</p>
<p>[3] A. Grover, J. Leskovec. ACM SIGKDD International Conference on Knowledge Discovery and Data Mining (KDD), 2016.</p>
<p>[4] Jin X., Han J. (2011) K-Means Clustering. In: Sammut C., Webb G.I. (eds) Encyclopedia of Machine Learning. Springer, Boston, MA. <a href="https://doi.org/10.1007/978-0-387-30164-8_425" target="_blank" rel="noopener">https://doi.org/10.1007/978-0-387-30164-8_425</a></p>

    </div>

    




<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/deep-learning/">Deep Learning</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://example.com/project/huawei-uk-university-challenge-competition-2021-main/readme/&amp;text=Data%20Science%20for%20Indoor%20positioning" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://example.com/project/huawei-uk-university-challenge-competition-2021-main/readme/&amp;t=Data%20Science%20for%20Indoor%20positioning" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Data%20Science%20for%20Indoor%20positioning&amp;body=https://example.com/project/huawei-uk-university-challenge-competition-2021-main/readme/" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://example.com/project/huawei-uk-university-challenge-competition-2021-main/readme/&amp;title=Data%20Science%20for%20Indoor%20positioning" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Data%20Science%20for%20Indoor%20positioning%20https://example.com/project/huawei-uk-university-challenge-competition-2021-main/readme/" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://example.com/project/huawei-uk-university-challenge-competition-2021-main/readme/&amp;title=Data%20Science%20for%20Indoor%20positioning" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://example.com/"><img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hu146c0e669bbb7677a5dcfd01bc64668c_18182_270x270_fill_q75_lanczos_center.jpg" alt="Rabia YAŞA KOŞTAŞ"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://example.com/">Rabia YAŞA KOŞTAŞ</a></h5>
      <h6 class="card-subtitle">PhD Candidate</h6>
      <p class="card-text">Rabia is a PhD student at School of Informatics, The University of Edinburgh, UK.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/rykostas" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=3aVUjnMAAAAJ&amp;hl=tr" target="_blank" rel="noopener">
        <i class="fas fa-graduation-cap"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/rykostas" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/rykostas/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


















    <div class="project-related-pages content-widget-hr">
      
      

      
      
      

      
      
      

      
      
      
    </div>
  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  

  

  
  






  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    © 2022 Me. This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">CC BY NC ND 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>




  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

      

    
    <script src="/js/vendor-bundle.min.e66e385e2f1df861699d60acd7a9c670.js"></script>

    
    
    
      

      
      

      

      
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/r.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/latex.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    
      
      
      
      
      
      
      
    

    

    
    
    
    <script id="page-data" type="application/json">{"use_headroom":true}</script>

    
    
      <script src="/js/wowchemy-headroom.c251366b4128fd5e6b046d4c97a62a51.js" type="module"></script>
    
    
    
    
    
    
    
      
      
    
    
    <script src="/en/js/wowchemy.min.ab2f2890dbe3e2e83579366d3d6e8fd9.js"></script>

    
    
    
    
    
    
      
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      <script src="/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js" type="module"></script>






</body>
</html>
